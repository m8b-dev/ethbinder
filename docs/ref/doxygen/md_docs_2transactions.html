<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ether Binder: Transactions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Ether Binder
   </div>
   <div id="projectbrief">Set of utilities for interacting with Ethereum and it&#39;s smart contracts with PHP, with generating ABI bindings and Ethereum-related types</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2transactions.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Transactions</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md40"></a></p>
<p>Concrete Transaction types extend abstract class Transaction, and this should be used for typing, unless explicit specific type of transaction is expected.</p>
<h1><a class="anchor" id="autotoc_md41"></a>
Supported types</h1>
<p>Ether binder right now supports Legacy transactions and London transactions. Blob transactions will be added when the spec will be finalized. Access list transactions will not be supported for generation in bindings Bear in mind, London transactions support Access List, but access list is not filled in from bindings.</p>
<h1><a class="anchor" id="autotoc_md42"></a>
Transaction types</h1>
<p>There is Enum for transaction types <code>TransactionType</code> that allows to select transaction type from type number (like in post-london format of transaction encoding - the first number of RLP, before transaction array), and it allows to instantiate it.</p>
<p>RPC has helper method to check if <a href="https://eips.ethereum.org/EIPS/eip-1559">EIP1559</a> transaction could be used on current chain.</p>
<h1><a class="anchor" id="autotoc_md43"></a>
Preparing Transaction</h1>
<p>To prepare transaction, create new transaction object, and fill in its fields using chainable method calls. Note: returned transaction is not clone, as it's the case with OOGmp, the output can be ignored.</p>
<p>Complete "bones" for transaction code are as follows: </p><div class="fragment"><div class="line">$key = \M8B\EtherBinder\Crypto\Key::fromHex(<span class="stringliteral">&quot;0x.....&quot;</span>);</div>
<div class="line">$rpc = new \M8B\EtherBinder\RPC\HttpRPC(<span class="stringliteral">&quot;https://...&quot;</span>);</div>
<div class="line"> </div>
<div class="line">$txn = new \M8B\EtherBinder\Common\LegacyTransaction();</div>
<div class="line"> </div>
<div class="line">$txn</div>
<div class="line">    -&gt;setTo($key-&gt;toAddress())</div>
<div class="line">    -&gt;setValue(<span class="keyword">new</span> \M8B\EtherBinder\Utils\OOGmp(0))</div>
<div class="line">    -&gt;setGasLimit(21000)</div>
<div class="line">    -&gt;setNonce($rpc-&gt;ethGetTransactionCount($key-&gt;toAddress())-&gt;toInt())</div>
<div class="line">    -&gt;setGasPrice($rpc-&gt;ethGasPrice())</div>
<div class="line">    -&gt;sign($key, $rpc-&gt;ethChainID());</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md44"></a>
RLP Decoding and Encoding</h1>
<p>Every transaction has 2 method for encoding and 2 methods for decoding. As in most places in the library, you get to choose if you want binary blob, or hexadecimal representation.</p>
<div class="fragment"><div class="line">$binary = $txn-&gt;encodeBin();</div>
<div class="line"><span class="comment">// don&#39;t echo binary to terminal, it may break it</span></div>
<div class="line">$hex = $txn-&gt;encodeHex();</div>
<div class="line">echo <span class="stringliteral">&quot;Encoded transaction: &quot;</span> . $hex . PHP_EOL;</div>
</div><!-- fragment --><p>Please note that there is also encoding for signing, which differs from encoding of entire transaction (like encoding for getting transaction hash)</p>
<div class="fragment"><div class="line">$chainId = $rpc-&gt;ethChainID();</div>
<div class="line">$txn-&gt;encodeHexForSigning($chainId);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md45"></a>
Other utilities</h1>
<p>There are other utility functions, which should be self-explanatory. </p><div class="fragment"><div class="line">$txn-&gt;hash()-&gt;toHex();</div>
<div class="line">$txn-&gt;getBaseFeeCap()-&gt;toString(); <span class="comment">// only for London Transactions</span></div>
<div class="line">$txn-&gt;getGasFeeTip()-&gt;toString(); <span class="comment">// only for London Transactions</span></div>
<div class="line">$txn-&gt;totalGasPrice(); <span class="comment">// for London base + tip, for legacy gas price</span></div>
<div class="line">$txn-&gt;to()-&gt;checksummed();</div>
<div class="line">$txn-&gt;isReplayProtected(); <span class="comment">// is EIP155</span></div>
<div class="line">$txn-&gt;useRpcEstimates($rpc, $key-&gt;toAddress()); <span class="comment">// use RPC to fill in gas limit and fees. Target low.</span></div>
<div class="line">$txn-&gt;useRpcEstimatesWithBump($rpc, $key-&gt;toAddress(), 10, 15); <span class="comment">// As above but bump gas limit by (here) 10%, and gas prices 15%</span></div>
<div class="line">$txn-&gt;nonce();</div>
<div class="line">$txn-&gt;transactionType(); <span class="comment">// enum</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
